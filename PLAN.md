## India Mega Seeder Script (Append-Only, Large, Full RAG+Ops)

### Summary
- No listed skill is applicable here (`skill-creator`/`skill-installer` are unrelated), so this will be implemented directly in-repo.
- Add a new Firestore seeding script that generates a **large India-only dataset** for hotels/rooms, restaurants/menu, tourist guides/guide services, tours/time-slots, cab drivers/services, and supporting traveler ops data.
- Keep it **append-only** (as selected), with a **large profile** by default, and an **optional `--reindex`** flag to rebuild Pinecone RAG vectors after seeding.
- Ensure famous Indian cities are covered and **Jabalpur is explicitly overrepresented** so RAG/search tests around Jabalpur are reliable.

### Files To Add/Update
- Add `backend/scripts/seed_india_megadata.py` (new main script).
- Keep existing `backend/seed_firestore.py` unchanged (legacy/basic seed path).
- Optionally add a short usage note in script docstring only (no additional docs required).

### Public Interface / CLI Contract
- New command:
  - `python backend/scripts/seed_india_megadata.py`
- Arguments:
  1. `--profile {large,very_large,massive}` (default: `large`)
  2. `--scope {full,requested,rag_core}` (default: `full`)
  3. `--append-only` (default true; no delete path implemented in this phase)
  4. `--seed INT` (default fixed integer for reproducible generation)
  5. `--run-tag STRING` (default autogenerated UTC tag)
  6. `--reindex` (optional full RAG reindex after Firestore writes)
  7. `--dry-run` (prints planned counts + city distribution, no writes)

### Data Targets (Large Profile, Chosen Defaults)
- Hotels: `400` BUSINESS users (`business_type=HOTEL`)
- Room types: `6000` (`15` per hotel, `users/{hotel_uid}/room_types`)
- Restaurants: `300` BUSINESS users (`business_type=RESTAURANT`)
- Menu items: `~4000` (`users/{restaurant_uid}/menu_items`)
- Guide providers: `220` BUSINESS users (`business_type=TOURIST_GUIDE_SERVICE`)
- Guide services: `1300` (`users/{guide_uid}/guide_services`)
- Tours: `500` (`tours` collection) + `4000` time slots (`8` per tour)
- Cab drivers: `250` BUSINESS users (`business_type=CAB_DRIVER`)
- Driver presence: `250` docs (`driver_presence`, mixed online/offline)
- Travelers: `180` users (`role=TRAVELER`)
- Itineraries: `280`, each with seeded `bookings` and `activities` subdocs
- Rides: `1500` + matching `ride_events` for driver/traveler ops testing

### City Strategy (India-Only + Jabalpur Priority)
- Use fixed Indian city catalog (all India addresses, city/state pairs).
- Include major/famous cities such as Mumbai, Delhi, Bengaluru, Hyderabad, Chennai, Kolkata, Jaipur, Udaipur, Goa (Panaji), Varanasi, Amritsar, Kochi, Pune, Ahmedabad, Srinagar, Chandigarh, Mysuru, Rishikesh, Bhopal, **Jabalpur**.
- Weighted distribution with hard minimums for Jabalpur:
  1. Hotels in Jabalpur: at least `35`
  2. Restaurants in Jabalpur: at least `25`
  3. Guide providers in Jabalpur: at least `18`
  4. Tours in Jabalpur: at least `30`
  5. Cab drivers in Jabalpur: at least `20`

### Image Strategy (Chosen: Live URLs)
- Generate deterministic, always-resolvable live URLs using filename-like seeds:
  - Pattern: `https://picsum.photos/seed/{image_name_seed}/1280/720`
- `image_name_seed` includes entity type + city + semantic token (e.g., `hotel_jabalpur_narmada_view_01`), satisfying the “image names” requirement while keeping UI-renderable URLs.
- Populate all expected image fields:
  1. Hotels: `business_profile.details.image_urls`
  2. Rooms: `images`, `cover_image`
  3. Restaurants: `business_profile.details.image_urls`
  4. Menu items: `images`, `cover_image`
  5. Guide services: `images`, `cover_image`
  6. Tours: `image_url`

### Implementation Plan
1. Implement a Firestore init helper in the new script using the same credential resolution style as current code (`serviceAccount.json` local fallback, then ADC).
2. Add a `SeedBatchWriter` utility with automatic commit every `<=450` operations to stay under Firestore 500-op batch limits.
3. Define deterministic catalogs:
   - Indian names, hotel adjectives, room types, amenities, cuisines, dish templates, guide categories, tour categories, ride status mix.
4. Build core generators per entity type that output documents matching current backend schemas:
   - `users` for all roles/business types
   - `room_types`, `menu_items`, `guide_services`, `tours/time_slots`, `driver_presence`, `rides/ride_events`, `itineraries/bookings/activities`
5. Ensure field compatibility with current validators/search/RAG builders:
   - `business_profile.details.*` keys exactly aligned with `validate_and_normalize_business_profile`
   - room/menu/guide payload shapes aligned with `_normalize_*` methods
   - guide services include `owner_uid`, `id`, `source=GUIDE_SERVICE`, owner/business metadata
   - tours include destination/location/category and price fields used by search + RAG
6. Add cross-linking logic:
   - bookings reference `hotel_owner_uid` and `room_type_id`
   - activities reference either `tour_id` or `guide_owner_uid + guide_service_id`
   - rides connect traveler/driver/city and include realistic status-dependent fields
7. Add append-only metadata to every generated doc:
   - `seed_meta`: `{ generator, profile, scope, run_tag, seeded_at }`
8. Add runtime summary output:
   - total writes, per-entity counts, per-city counts, Jabalpur counts, elapsed time.
9. Implement optional `--reindex` path:
   - import and call `full_reindex(dry_run=False)` from `rag_indexer_service`
   - print indexed/total result.

### Validation Scenarios
1. Dry-run shape check:
   - `python backend/scripts/seed_india_megadata.py --dry-run`
   - confirms target counts, city mix, Jabalpur minimums.
2. Write smoke test:
   - run script with defaults and verify summary shows non-zero counts for all selected entities.
3. Search API smoke tests:
   - `/api/search/hotels?destination=Jabalpur`
   - `/api/search/restaurants?destination=Jabalpur`
   - `/api/search/tours?destination=Jabalpur`
   - each must return meaningful results.
4. RAG smoke test:
   - run with `--reindex`, then query retrieval for Jabalpur intents and verify HOTEL/RESTAURANT/TOUR/GUIDE_SERVICE matches appear.
5. Data integrity checks:
   - all seeded locations end with India-based city/state
   - image fields are populated with live URLs
   - no required field missing for current serializers/search logic.

### Assumptions and Locked Defaults
- **Run mode**: append-only (no cleanup of previous sample data).
- **Scope**: full RAG + ops entities.
- **Volume**: large profile defaults listed above.
- **Images**: live URL mode with deterministic image-name seeds.
- **Geography**: India-only strings; Jabalpur mandatory with elevated volume.
- **No REST API/type contract changes**: only a new CLI seeding interface is added.
